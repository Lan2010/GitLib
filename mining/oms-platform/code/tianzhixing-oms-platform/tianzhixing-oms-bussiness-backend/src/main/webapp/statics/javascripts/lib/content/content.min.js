var handleTab,aTab;$(function(){function e(e){var t=0;return $(e).each(function(){t+=$(this).outerWidth(!0)}),t}function t(t){var a=e($(t).prevAll()),i=e($(t).nextAll()),n=e($(".content-tabs").children().not(".J_menuTabs")),r=$(".content-tabs").outerWidth(!0)-n,s=0;if($(".page-tabs-content").outerWidth()<r)s=0;else if(i<=r-$(t).outerWidth(!0)-$(t).next().outerWidth(!0)){if(r-$(t).next().outerWidth(!0)>i){s=a;for(var o=t;s-$(o).outerWidth()>$(".page-tabs-content").outerWidth()-r;)s-=$(o).prev().outerWidth(),o=$(o).prev()}}else a>r-$(t).outerWidth(!0)-$(t).prev().outerWidth(!0)&&(s=a-$(t).prev().outerWidth(!0));$(".page-tabs-content").animate({marginLeft:0-s+"px"},"fast")}function a(){var t=Math.abs(parseInt($(".page-tabs-content").css("margin-left"))),a=e($(".content-tabs").children().not(".J_menuTabs")),i=$(".content-tabs").outerWidth(!0)-a,n=0;if($(".page-tabs-content").width()<i)return!1;for(var r=$(".J_menuTab:first"),s=0;s+$(r).outerWidth(!0)<=t;)s+=$(r).outerWidth(!0),r=$(r).next();if(s=0,e($(r).prevAll())>i){for(;s+$(r).outerWidth(!0)<i&&r.length>0;)s+=$(r).outerWidth(!0),r=$(r).prev();n=e($(r).prevAll())}$(".page-tabs-content").animate({marginLeft:0-n+"px"},"fast")}function i(){var t=Math.abs(parseInt($(".page-tabs-content").css("margin-left"))),a=e($(".content-tabs").children().not(".J_menuTabs")),i=$(".content-tabs").outerWidth(!0)-a,n=0;if($(".page-tabs-content").width()<i)return!1;for(var r=$(".J_menuTab:first"),s=0;s+$(r).outerWidth(!0)<=t;)s+=$(r).outerWidth(!0),r=$(r).next();for(s=0;s+$(r).outerWidth(!0)<i&&r.length>0;)s+=$(r).outerWidth(!0),r=$(r).next();n=e($(r).prevAll()),n>0&&$(".page-tabs-content").animate({marginLeft:0-n+"px"},"fast")}handleTab=function e(){var a=$(this).attr("href"),i=$(this).data("index"),n=$.trim($(this).text()),e=!0;if(void 0==a||0==$.trim(a).length)return!1;if($(".J_menuTab").each(function(){return $(this).data("id")==a?($(this).hasClass("active")||($(this).addClass("active").siblings(".J_menuTab").removeClass("active"),t(this),$(".J_mainContent .J_iframe").each(function(){return $(this).data("id")==a?($(this).show().siblings(".J_iframe").hide(),!1):void 0})),e=!1,!1):void 0}),e){var r='<a href="javascript:;" class="active J_menuTab" data-id="'+a+'">'+n+' <i class="fa fa-times-circle"></i></a>';$(".J_menuTab").removeClass("active");var s='<iframe class="J_iframe" name="iframe'+i+'" width="100%" height="100%" src="'+a+'" frameborder="0" data-id="'+a+'" seamless></iframe>';$(".J_mainContent").find("iframe.J_iframe").hide().parents(".J_mainContent").append(s);var o=layer.load();$(".J_mainContent iframe:visible").load(function(){layer.close(o)}),$(".J_menuTabs .page-tabs-content").append(r),t($(".J_menuTab.active"))}if(!e){$(".J_mainContent iframe:visible").remove();var s='<iframe class="J_iframe" name="iframe'+i+'" width="100%" height="100%" src="'+a+'" frameborder="0" data-id="'+a+'" seamless></iframe>';$(".J_mainContent").find("iframe.J_iframe").hide().parents(".J_mainContent").append(s);var o=layer.load();$(".J_mainContent iframe:visible").load(function(){layer.close(o)}),$(".J_menuTabs .page-tabs-content").append(r),t($(".J_menuTab.active"))}return!1};aTab=function e(a){var i=$(a).attr("href"),n=$(a).data("index")===undefined?$.trim(i).length+1:$(a).data("index"),r=$.trim($(a).attr("data-tabTitle")),s=!0,o=false;if(void 0==i||0==$.trim(i).length)return!1;if($(parent.document).find(".J_menuTab").each(function(e,n){if($(n).data("id")==i){$(n).remove();o=true}return $(a).data("id")==i?($(a).hasClass("active")||($(a).addClass("active").siblings(".J_menuTab").removeClass("active"),t(a),$(parent.document).find(".J_mainContent .J_iframe").each(function(e,t){return $(a).data("id")==i?($(a).show().siblings(".J_iframe").hide(),!1):void 0})),s=!1,!1):void 0}),s){if(!o){var d='<a href="javascript:;" class="active J_menuTab" data-id="'+i+'">'+r+' <i class="fa fa-times-circle"></i></a>';$(parent.document).find(".J_menuTab").removeClass("active");var c='<iframe class="J_iframe" name="iframe'+n+'" width="100%" height="100%" src="'+i+'" frameborder="0" data-id="'+i+'" seamless></iframe>';$(parent.document).find(".J_mainContent").find("iframe.J_iframe").hide().parents(".J_mainContent").append(c);$(parent.document).find(".J_menuTabs .page-tabs-content").append(d),t($(parent.document).find(".J_menuTab.active"));var m=layer.load();$(parent.document).find(".J_mainContent iframe:visible").load(function(){layer.close(m)})}else{$(parent.document).find(".J_mainContent .J_iframe").each(function(e,a){if($(a).data("id")==i){$(parent.document).find(".J_menuTab").removeClass("active");$(parent.document).find(".J_mainContent iframe:visible").hide();$(a).remove();var s='<a href="javascript:;" class="active J_menuTab" data-id="'+i+'">'+r+' <i class="fa fa-times-circle"></i></a>';var o='<iframe class="J_iframe" name="iframe'+n+'" width="100%" height="100%" src="'+i+'" frameborder="0" data-id="'+i+'" seamless></iframe>';$(parent.document).find(".J_mainContent").find("iframe.J_iframe").hide().parents(".J_mainContent").append(o);$(parent.document).find(".J_menuTabs .page-tabs-content").append(s),t($(parent.document).find(".J_menuTab.active"));var d=layer.load();$(parent.document).find(".J_mainContent iframe:visible").load(function(){layer.close(d)})}})}}return!1};function n(){var e=$(this).parents(".J_menuTab").data("id"),a=$(this).parents(".J_menuTab").width();if($(this).parents(".J_menuTab").hasClass("active")){if($(this).parents(".J_menuTab").next(".J_menuTab").size()){var i=$(this).parents(".J_menuTab").next(".J_menuTab:eq(0)").data("id");$(this).parents(".J_menuTab").next(".J_menuTab:eq(0)").addClass("active"),$(".J_mainContent .J_iframe").each(function(){return $(this).data("id")==i?($(this).show().siblings(".J_iframe").hide(),!1):void 0});var n=parseInt($(".page-tabs-content").css("margin-left"));0>n&&$(".page-tabs-content").animate({marginLeft:n+a+"px"},"fast"),$(this).parents(".J_menuTab").remove(),$(".J_mainContent .J_iframe").each(function(){return $(this).data("id")==e?($(this).remove(),!1):void 0})}if($(this).parents(".J_menuTab").prev(".J_menuTab").size()){var i=$(this).parents(".J_menuTab").prev(".J_menuTab:last").data("id");$(this).parents(".J_menuTab").prev(".J_menuTab:last").addClass("active"),$(".J_mainContent .J_iframe").each(function(){return $(this).data("id")==i?($(this).show().siblings(".J_iframe").hide(),!1):void 0}),$(this).parents(".J_menuTab").remove(),$(".J_mainContent .J_iframe").each(function(){return $(this).data("id")==e?($(this).remove(),!1):void 0})}}else $(this).parents(".J_menuTab").remove(),$(".J_mainContent .J_iframe").each(function(){return $(this).data("id")==e?($(this).remove(),!1):void 0}),t($(".J_menuTab.active"));return!1}function r(){$(".page-tabs-content").children("[data-id]").not(":first").not(".active").each(function(){$('.J_iframe[data-id="'+$(this).data("id")+'"]').remove(),$(this).remove()}),$(".page-tabs-content").css("margin-left","0")}function s(){t($(".J_menuTab.active"))}var o={"tpl/LetterManage/surveydata.html":"true","tpl/LetterManage/finalSurveydata.html":"true"};function d(){if(!$(this).hasClass("active")){var e=$(this).data("id");$(".J_mainContent .J_iframe").each(function(){$(this).data("id")===e&&o[e]&&window.frames[$(this).attr("name")].location.reload();return $(this).data("id")==e?($(this).show().siblings(".J_iframe").hide(),!1):void 0}),$(this).addClass("active").siblings(".J_menuTab").removeClass("active"),t(this)}}function c(){var e=$('.J_iframe[data-id="'+$(this).data("id")+'"]'),t=e.attr("src"),a=layer.load();e.attr("src",t).load(function(){layer.close(a)})}$(".J_menuItem").each(function(e){$(this).attr("data-index")||$(this).attr("data-index",e)}),$(".J_menuTabs").on("click",".J_menuTab i",n),$(".J_tabCloseOther").on("click",r),$(".J_tabShowActive").on("click",s),$(".J_menuTabs").on("click",".J_menuTab",d),$(".J_menuTabs").on("dblclick",".J_menuTab",c),$(".J_tabLeft").on("click",a),$(".J_tabRight").on("click",i),$(".J_tabCloseAll").on("click",function(){$(".page-tabs-content").children("[data-id]").not(":first").each(function(){$('.J_iframe[data-id="'+$(this).data("id")+'"]').remove(),$(this).remove()}),$(".page-tabs-content").children("[data-id]:first").each(function(){$('.J_iframe[data-id="'+$(this).data("id")+'"]').show(),$(this).addClass("active")}),$(".page-tabs-content").css("margin-left","0")})});$(function(){function e(e){return window.frames[e]}function t(e,t){e=$(e),e.hover(function(){e.addClass("animated "+t)},function(){window.setTimeout(function(){e.removeClass("animated "+t)},2e3)})}function a(){var e="[class*=col]",t=".ibox-title",a="[class*=col]";$(e).sortable({handle:t,connectWith:a,tolerance:"pointer",forcePlaceholderSize:!0,opacity:.8}).disableSelection()}var i=window.parent.document;if($(".tooltip-demo").tooltip({selector:"[data-toggle=tooltip]",container:"body"}),$(".modal").appendTo("body"),$("[data-toggle=popover]").popover(),$(".collapse-link").click(function(){var e=$(this).closest("div.ibox"),t=$(this).find("i"),a=e.find("div.ibox-content");a.slideToggle(200),t.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),e.toggleClass("").toggleClass("border-bottom"),setTimeout(function(){e.resize(),e.find("[id^=map-]").resize()},50)}),$(".close-link").click(function(){var e=$(this).closest("div.ibox");e.remove()}),top==this){}});